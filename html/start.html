<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@1,300&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Doto:ROND@65&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/csshake-slow.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://fav.farm/游볩" />
    <link rel="stylesheet" href="../css/style.css" />
    <title>U.F.S</title>
</head>
<body>
    <!-- <div class="ULT"></div> -->

    <div class="ontop" id="ontop"></div>
    <div class="ontop2" id="ontop2"></div>
    <div class="vs" id="vs"></div>

    <img src="../content/images/ENEMY.png" alt="" style="height: 570px; width: 500px;" id="image1" class="untouchable">
    <img src="../content/images/ENEMY.png" alt="" style="height: 570px; width: 500px;" id="image2" class="invert untouchable">
    <button class="button" id="qbutton">q</button>
    <button class="button" id="sebutton">w</button>
    <button class="button" id="ebutton">e</button>
    <button class="button3" id="debutton">e</button>
    <button class="button3" id="febutton">e</button>
    <button class="button2" id="pbutton">p</button>
    <button class="button2" id="febutton">[</button>
    <button class="button2" id="]button">]</button>
    <script>
        let maxhpenemy1 = 100
        let maxhpenemy2 = 100
        let hpenemy1 = 100
        let hpenemy2 = 100

        let punch1 = 10
        let punch2 = 10

        let heal1 = -5
        let heal2 = -5

        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                player1: params.get('player1') || 'Unknown',
                player2: params.get('player2') || 'Unknown',
                funnymode: params.get('funnymode') || 'false',
                lobotomymode: params.get('lobotomymode') || 'false',
                amogusmode: params.get('amogusmode') || 'false'
            };
        }

        const { player1, player2, funnymode, lobotomymode, amogusmode} = getQueryParams();
        console.log(player1,player2,funnymode,lobotomymode,amogusmode)
        // ${player1}; ${player2};

        if (funnymode === 'true') {
            punch1 = punch1 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);
            punch2 = punch2 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);
            heal1 = heal1 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);
            heal2 = heal2 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);

            maxhpenemy1 = maxhpenemy1 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);
            maxhpenemy2 = maxhpenemy2 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);

            hpenemy1 = hpenemy1 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);
            hpenemy2 = hpenemy2 + Math.floor(Math.random() * (30 - (-9) + 1)) + (-9);
        }

        if (player1) {
            if (player1 === "venom") {
                punch1 += 5
            }
            if (player1 === "ivanzolo2009") {
               heal1 -= 5
            }
            if (player1 === "snoopdogg") {
                maxhpenemy1 += 75
                hpenemy1 = maxhpenemy1
                punch1 -= 5
            }
            if (player1 === "rinat") {
                maxhpenemy1 += 20
                hpenemy1 = maxhpenemy1
            }
        }

        if (player2) {
            if (player2 === "venom") {
                punch2 += 5
            }
            if (player2 === "ivanzolo2009") {
               heal2 -= 5
            }
            if (player2 === "snoopdogg") {
                maxhpenemy2 += 75
                hpenemy2 = maxhpenemy2
                punch2 -= 5
            }
            if (player2 === "rinat") {
                maxhpenemy2 += 20
                hpenemy2 = maxhpenemy2
            }
        }
        
        var audioElement = new Audio();
        audioElement.src = './content/music/battle.mp3';
        
        audioElement.volume = 0.5; // 햆햩혪 햠쮏햣햣 햪혪햡햨쮏 향쒬햨햟
        audioElement.preload = 'auto';

        let reagate = 20
        let happened = 0

        var myListener = function () {
            happened = happened + 1
            if (happened >= reagate) {
                document.removeEventListener('mousemove', myListener, false);
                audioElement.play();
            }    
        };

        document.addEventListener('mousemove', myListener, false);

        let debounce = false
        let debounce2 = false
        let block1 = false
        let block2 = false

        // CHEATS
        let godmodePLR1 = false
        let godmodePLR2 = false

        let infdamagePLR1 = false
        let infdamagePLR2 = false

        let SECRETMODEplr1 = false
        let SECRETMODEplr2 = true
        //

        let imag = document.querySelector('#image1')
        let imag2 = document.querySelector('#image2')

        let hpenemy1v = document.querySelector('#ontop')
        let hpenemy2v = document.querySelector('#ontop2')

        let vsImag = document.querySelector("#vs")

        let cd = true

        function cdf(who){
            cd = false
            hpenemy1v.textContent = String(hpenemy1) + "/" + String(maxhpenemy1)
            hpenemy2v.textContent = String(hpenemy2) + "/" + String(maxhpenemy2)
            vsImag.display = 'none'
            var audioElement2 = new Audio();
                            audioElement2.src = 'content/music/fight.mp3';
                            audioElement2.volume = 0.25; // 햆햩혪 햠쮏햣햣 햪혪햡햨쮏 향쒬햨햟
                            audioElement2.preload = 'auto';
                            audioElement2.play()
        }
        function cde0(who){
            hpenemy1v.textContent = '0'
            hpenemy2v.textContent = '0'
        }
        function cde1(who){
            hpenemy1v.textContent = '1'
            hpenemy2v.textContent = '1'
        }
        function cde2(who){
            hpenemy1v.textContent = '2'
            hpenemy2v.textContent = '2'
        }
        function cde3(who){
            hpenemy1v.textContent = '3'
            hpenemy2v.textContent = '3'
        }

        setTimeout(cde3, 1000)  
        setTimeout(cde2, 2000)  
        setTimeout(cde1, 3000)  
        setTimeout(cde0, 4000) 
        setTimeout(cdf, 5000)  

        window.addEventListener("keydown", moveRect);
        window.addEventListener("keyup", moveRect2);

        const btn = document.getElementById("ebutton")
        const btn2 = document.getElementById("]button")

        const btn3 = document.getElementById("qbutton")
        const btn4 = document.getElementById("pbutton")

        function damagecontrol(enm,damage) {
            if (enm) {
                if (enm === imag) {
                    if (player1 === "kjrinat") {
                        var d = Math.random();
                        if (d > 0.7) {
                            hpenemy1 = hpenemy1 + damage*2
                        }
                    }
                    hpenemy1 = hpenemy1 - damage
                    hpenemy1v.textContent = String(hpenemy1) + "/" + String(maxhpenemy1)
                }
                if (enm === imag2) {
                    if (player2 === "kjrinat") {
                        var d = Math.random();
                        if (d > 0.7) {
                            hpenemy2 = hpenemy2 + damage*2
                        }
                    }
                    hpenemy2 = hpenemy2 - damage
                    hpenemy2v.textContent = String(hpenemy2) + "/" + String(maxhpenemy2)
                }
            }
        }

        function imagecontrol(image,to){
            if (to) {
                if (to.toLowerCase().endsWith('.png')) {
                    if (player2 === "Unknown") {
                        image.src = '../content/images/enemystun.png'
                    }
                    if (player2 === "plankton") {
                        image.src = "../content/images/Plankton/P_"+to
                    }
                    if (player2 === "venom") {
                        image.src = "../content/images/Venom/V_"+to
                    }
                    if (player2 === "ivanzolo2009") {
                        image.src = "../content/images/Ivanzolo/I_"+to
                    }
                    if (player2 === "snoopdogg") {
                        image.src = "../content/images/SnoopDogg/sd.gif"
                    }
                    if (player2 === "rinat") {
                        image.src = "../content/images/Default/"+to
                    }
                    if (player2 === "kjrinat") {
                        image.src = "../content/images/KjRinat/K_"+to
                    }
                    if (amogusmode === 'true') {
                        var d = Math.random();
                        var sdf=true
                        if (d > 0.2) {
                            image.src = "../content/images/Amogus/sd.gif"
                            sdf = false
                        }
                        if (d > 0.4) {
                            image.src = "../content/images/Amogus/sd2.gif"
                            sdf = false
                        }
                        if (d > 0.6) {
                            image.src = "../content/images/Amogus/sd3.gif"
                            sdf = false
                        }
                        if (d > 0.8) {
                            image.src = "../content/images/Amogus/sd4.gif"
                            sdf = false
                        }
                        if (sdf === true) {
                            image.src = "../content/images/Amogus/sd5.gif"
                        }
                    }
                    if (lobotomymode === 'true') {
                        const folders = {
                            "Venom": ["V_anim1.png", "V_anim2.png", "V_ENEMY.png","V_blockenemy.png","V_DamagedEnemy.png","V_drink.png","V_LOSE.png","V_VICTORY.png"],
                            "SnoopDogg": ["sd.gif"],
                            "Plankton": ["P_anim1.png", "P_anim2.png", "P_ENEMY.png","P_blockenemy.png","P_DamagedEnemy.png","P_drink.png","P_LOSE.png","P_VICTORY.png"],
                            "KjRinat": ["K_anim1.png", "K_anim2.png", "K_ENEMY.png","K_blockenemy.png","K_DamagedEnemy.png","K_drink.png","K_LOSE.png","K_VICTORY.png"],
                            "Ivanzolo": ["I_anim1.png", "I_anim2.png", "I_ENEMY.png","I_blockenemy.png","I_DamagedEnemy.png","I_drink.png","I_LOSE.png","I_VICTORY.png"],
                            "Default": ["anim1.png", "anim2.png", "ENEMY.png","blockenemy.png","DamagedEnemy.png","drink.png","LOSE.png","VICTORY.png"],
                        };

                        // Pick a random folder
                        const folderNames = Object.keys(folders);
                        const randomFolder = folderNames[Math.floor(Math.random() * folderNames.length)];
                        
                        // Get random image from the selected folder
                        const images = folders[randomFolder];
                        const randomImage = images[Math.floor(Math.random() * images.length)];
                        // Set the image in the div
                        image.src=`../content/images/${randomFolder}/${randomImage}`
                    }
                }
                else {
                    // image.src = "../content/images/sd.gif"
                    if (player2 === "Unknown") {
                        image1.src = '../content/images/enemystun.png'
                    }
                    if (player1 === "plankton") {
                        image.src = "../content/images/Plankton/P_"+to+".png"
                    }
                    if (player1 === "venom") {
                        image.src = "../content/images/Venom/V_"+to+".png"
                    }
                    if (player1 === "ivanzolo2009") {
                        image.src = "../content/images/Ivanzolo/I_"+to+".png"
                    }
                    if (player1 === "snoopdogg") {
                        image.src = "../content/images/SnoopDogg/sd.gif"
                    }
                    if (player1 === "rinat") {
                        image.src = "../content/images/Default/"+to+".png"
                    }
                    if (player1 === "kjrinat") {
                        image.src = "../content/images/KjRinat/K_"+to+".png"
                    }
                    if (lobotomymode === 'true') {
                        const folders = {
                            "Venom": ["V_anim1.png", "V_anim2.png", "V_ENEMY.png","V_blockenemy.png","V_DamagedEnemy.png","V_drink.png","V_LOSE.png","V_VICTORY.png"],
                            "SnoopDogg": ["sd.gif"],
                            "Plankton": ["P_anim1.png", "P_anim2.png", "P_ENEMY.png","P_blockenemy.png","P_DamagedEnemy.png","P_drink.png","P_LOSE.png","P_VICTORY.png"],
                            "KjRinat": ["K_anim1.png", "K_anim2.png", "K_ENEMY.png","K_blockenemy.png","K_DamagedEnemy.png","K_drink.png","K_LOSE.png","K_VICTORY.png"],
                            "Ivanzolo": ["I_anim1.png", "I_anim2.png", "I_ENEMY.png","I_blockenemy.png","I_DamagedEnemy.png","I_drink.png","I_LOSE.png","I_VICTORY.png"],
                            "Default": ["anim1.png", "anim2.png", "ENEMY.png","blockenemy.png","DamagedEnemy.png","drink.png","LOSE.png","VICTORY.png"],
                        };

                        // Pick a random folder
                        const folderNames = Object.keys(folders);
                        const randomFolder = folderNames[Math.floor(Math.random() * folderNames.length)];
                        
                        // Get random image from the selected folder
                        const images = folders[randomFolder];
                        const randomImage = images[Math.floor(Math.random() * images.length)];
                        // Set the image in the div
                        image.src=`../content/images/${randomFolder}/${randomImage}`
                    }
                    if (amogusmode === 'true') {
                        var d = Math.random();
                        var sdf=true
                        if (d > 0.2) {
                            image.src = "../content/images/Amogus/sd.gif"
                            sdf = false
                        }
                        if (d > 0.4) {
                            image.src = "../content/images/Amogus/sd2.gif"
                            sdf = false
                        }
                        if (d > 0.6) {
                            image.src = "../content/images/Amogus/sd3.gif"
                            sdf = false
                        }
                        if (d > 0.8) {
                            image.src = "../content/images/Amogus/sd4.gif"
                            sdf = false
                        }
                        if (sdf === true) {
                            image.src = "../content/images/Amogus/sd5.gif"
                        }
                    }
                }
            }
        }

        imagecontrol(imag,"ENEMY")
        imagecontrol(imag2,"ENEMY.png")

        function moveRect2(e){
            if (cd) {
                return
            }
            if (hpenemy2 <= 0) {
                imagecontrol(imag,'VICTORY')
                imagecontrol(imag2,'LOSE.png')
                return
            }
            if (hpenemy1 <= 0) {
                imagecontrol(imag2,'VICTORY.png')
                imagecontrol(imag,'LOSE')
                return
            }
            if (e.key === 'Tab') {
                if (godmodePLR1 == true) {
                    godmodePLR1 = false
                }
                else
                {
                    godmodePLR1 = true
                }
            }
            if (e.key === '`') {
                if (infdamagePLR1 == true) {
                    infdamagePLR1 = false
                }
                else
                {
                    infdamagePLR1 = true
                }
            }
            if (e.key === '-') {
                if (godmodePLR2 == true) {
                    godmodePLR2 = false
                }
                else
                {
                    godmodePLR2 = true
                }
            }
            if (e.key === '+') {
                if (infdamagePLR2 == true) {
                    infdamagePLR2 = false
                }
                else
                {
                    infdamagePLR2 = true
                }
            }
            if (e.key === 'e') {
                if (!debounce) {
                    imagecontrol(imag,'ENEMY')
                    debounce = false
                    block1 = false
                    console.log(btn)
                    btn.style.border = "3px solid white"
                }
            }
            if (e.key === ']') {
                if (!debounce2) {
                    imagecontrol(imag2,'ENEMY.png')
                    debounce2 = false
                    block2 = false
                    btn2.style.border = "3px solid white"
                }
            }
        }
        function moveRect(e){
            if (cd) {
                return
            }
            if (hpenemy2 <= 0) {
                imagecontrol(imag,'VICTORY')
                imagecontrol(imag2,'LOSE.png')
                return
            }
            if (hpenemy1 <= 0) {
                imagecontrol(imag2,'VICTORY.png')
                imagecontrol(imag,'LOSE')
                return
            }
            if (e.key === "w") {
                if (!debounce) {
                    debounce = true
                    function back() {
                        damagecontrol(imag,heal1)
                        imagecontrol(imag,'ENEMY')
                        debounce = false
                    }
                    imagecontrol(imag,'drink')
                    setTimeout(back,500)
                }
            }
            if (e.key === "q") {
                btn3.style.border = "3px solid black"
                if (!debounce) {
                    function attack(who){
                        imagecontrol(imag,'anim2')
                        setTimeout(attack3, 100)  
                    }

                    function attack2(who){
                        imagecontrol(imag,'anim1')
                        setTimeout(attack, 200)
                    }

                    function attack3(who){
                        function back(){
                            imagecontrol(imag2,'ENEMY.png')
                        }
                        btn3.style.border = "3px solid white"
                        if (!block2) {
                            var audioElement2 = new Audio();
                            audioElement2.src = 'content/music/udar.mp3';
                            audioElement2.volume = 0.25; // 햆햩혪 햠쮏햣햣 햪혪햡햨쮏 향쒬햨햟
                            audioElement2.preload = 'auto';
                            audioElement2.play()
                            if (!godmodePLR2) {
                                imagecontrol(imag2,'DamagedEnemy.png')
                                setTimeout(back,100)
                                console.log('punch 2 enemy success')
                                if (!infdamagePLR1) {
                                    damagecontrol(imag2,punch1)
                                }
                                else {
                                    // hpenemy2 = hpenemy2 - 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                                }
                            }
                        }
                        else {
                            
                            var audioElement3 = new Audio();
                            audioElement3.src = 'content/music/blockudar.mp3';
                            audioElement3.volume = 0.25; // 햆햩혪 햠쮏햣햣 햪혪햡햨쮏 향쒬햨햟
                            audioElement3.preload = 'auto';
                            audioElement3.play()
                            imagecontrol(imag2,'ENEMY.png') 
                            debounce2 = false
                            block2 = false
                            btn2.style.border = "3px solid white"
                            console.log('punch 2 enemy fail')
                        }
                        imagecontrol(imag,'ENEMY')
                        debounce = false
                    }  

                    debounce = true
                    setTimeout(attack2, 1)  
                }
            }
            if (e.key === "[") {
                if (!debounce2) {
                    debounce2 = true
                    function back() {
                        imagecontrol(imag2,'ENEMY.png')
                        debounce2 = false
                        damagecontrol(imag2,heal2)
                        
                    }
                    imagecontrol(imag2,'drink.png')
                    setTimeout(back,500)
                }
            }
            if (e.key === "p") {
                btn4.style.border = "3px solid black"
                if (!debounce2) {
                    function attack(who){
                        imagecontrol(imag2,'anim2.png')
                        setTimeout(attack3, 100)  
                    }

                    function attack2(who){
                        imagecontrol(imag2,'anim1.png')
                        setTimeout(attack, 200)
                    }

                    function attack3(who){
                        function back(){
                            imagecontrol(imag,'ENEMY')
                        }
                        btn4.style.border = "3px solid white"
                        if (!block1) {
                            var audioElement2 = new Audio();
                            audioElement2.src = 'content/music/udar.mp3';
                            audioElement2.volume = 0.25; // 햆햩혪 햠쮏햣햣 햪혪햡햨쮏 향쒬햨햟
                            audioElement2.preload = 'auto';
                            audioElement2.play()
                            if (!godmodePLR2) {
                                imagecontrol(imag,'DamagedEnemy')
                                setTimeout(back,100)
                                if (!infdamagePLR1) {
                                    damagecontrol(imag,punch2)
                                   
                                }
                                else {
                                    // hpenemy1 = hpenemy1 - 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                                }
                                console.log('punch 1 enemy success')
                            }
                        }
                        else {
                            
                            var audioElement3 = new Audio();
                            audioElement3.src = 'content/music/blockudar.mp3';
                            audioElement3.volume = 0.25; // 햆햩혪 햠쮏햣햣 햪혪햡햨쮏 향쒬햨햟
                            audioElement3.preload = 'auto';
                            audioElement3.play()
                            imagecontrol(imag,'DamagedEnemy')
                            debounce = false
                            block1 = false
                            console.log(btn)
                            btn.style.border = "3px solid white"
                            console.log('punch 1 enemy fail')
                        }
                        imagecontrol(imag2,'ENEMY.png')
                        debounce2 = false
                    }  

                    debounce2 = true
                    setTimeout(attack2, 1)  
                }
            }
            if (e.key === 'e') {
                if (!debounce) {
                    imagecontrol(imag,'blockenemy')
                    block1 = true
                    btn.style.border = "3px solid black"
                }
            }
            if (e.key === ']') {
                if (!debounce2) {
                    imagecontrol(imag2,'blockenemy.png')
                    block2 = true
                    btn2.style.border = "3px solid black"
                }
            }
        }

        
    </script>
    <script>
        // Function to modify all <a> tags so they preserve the query parameters
        function preserveDataOnLinks() {
        const currentUrl = new URL(window.location.href); // Get the current URL
        const currentParams = currentUrl.searchParams; // Get current query parameters

        // Add an event listener to all anchor tags
        document.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', function(event) {
            const href = new URL(link.href); // Get the href of the clicked link
            // Append all the current query parameters to the href of the clicked link
            currentParams.forEach((value, key) => {
                href.searchParams.set(key, value);
            });
            
            // Update the link's href with the modified URL
            link.href = href.toString();
            });
        });
        }
    </script>
</body>
